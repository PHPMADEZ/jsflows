<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

</head>

<body>
    <script src="https://raw.githack.com/SortableJS/Sortable/master/Sortable.js"></script>
    <!--card-->
    <div class="container p-5">
        <div class="row">
            <div class="col-12">
                <button onclick="createBlankCard()">Add Card</button>
            </div>
        <div class="card" style="width: 18rem;"></div>
    
            <div id="card-container" id="simpleList" class="list-group">
        </div>
        </div>

    </div>



</body>


<script>

    // niet vergeten om object checks te doen op de item en de value 
    var cardCounter = 0;
    function createCardsFromJSON() {
        fetch('flow.json')
            .then(response => response.json())
            .then(data => {
                Object.keys(data.sections).forEach(key => {
                    let section = data.sections[key];
                    cardCounter++;
                    let card = document.createElement('div');
                    card.classList.add('card');
                    card.classList.add('list-grouo-items');
                    card.setAttribute('id', `card-${cardCounter}`);
                    let title = document.createElement('h2');
                    title.innerHTML = section.section;
                    card.appendChild(title);

                    let content = document.createElement('p');
                    let sectionContent = '';
                    Object.entries(section).forEach(([key, value]) => {
                        if (Array.isArray(value)) {
                            sectionContent += `<b>${key}</b> :`;
                            value.forEach(item => {
                                if (typeof item === 'object') {
                                    if (Array.isArray(item)) {
                                        item.forEach(t => {
                                            Object.entries(t).forEach(([k, v]) => {
                                                sectionContent += `<b>${k}</b> : ${v} <br>`;
                                            });
                                            sectionContent += '<br>';
                                        });

                                    } else {
                                        Object.entries(item).forEach(([k, v]) => {
                                            sectionContent += `<b>${k}</b> : ${v} <br>`;
                                        });
                                        sectionContent += '<br>';
                                    }

                                } else {
                                    sectionContent += '<br>' + item;

                                }

                            });
                        } else if (typeof value === 'object') {
                            sectionContent += `<b>${key}</b> :`;
                            Object.entries(value).forEach(([k, v]) => {
                                sectionContent += `<b>${k}</b> : ${v} <br>`;

                            });
                            sectionContent += '<br>';
                        } else {
                            sectionContent += `<b>${key}</b> : ${value} <br>`;

                        }
                    });
                    content.innerHTML = sectionContent;
                    card.appendChild(content);

                    let container = document.getElementById('card-container');
                    container.appendChild(card);

                    var simpleList = container;
                    console.log(simpleList);
                    Sortable.create(simpleList, { /* options */ });


                });
            });


    }


    function createBlankCard()
    {
 

        cardCounter++;
        let card = document.createElement('div');

        let doneButton = document.createElement('button');
doneButton.innerHTML = "Edit";
doneButton.style.display = 'none';
card.appendChild(doneButton);

        card.classList.add('card');
        card.classList.add('list-group-items');
        card.setAttribute('id', `card-${cardCounter}`);
        let title = document.createElement('h2');
        title.innerHTML = 'section';
        card.appendChild(title);

        let container = document.getElementById('card-container');
        container.appendChild(card);

        var simpleList = container;
        console.log(simpleList);
        Sortable.create(simpleList, { /* options */ });

        let titleInput = document.createElement('input');
        titleInput.value = 'section';
        titleInput.addEventListener('input', (event) => {
            title.innerHTML = event.target.value;
        });
        card.appendChild(titleInput);
        
        let content = document.createElement('p');
        content.innerHTML = 'content';
        card.appendChild(content);

        let contentInput = document.createElement('input');
        contentInput.value = 'content';
        contentInput.addEventListener('input', (event) => {
            content.innerHTML = event.target.value;
        });
        card.appendChild(contentInput);

        

card.addEventListener('mouseover', (event) => {
    doneButton.style.display = 'block';
});

card.addEventListener('mouseout', (event) => {
    doneButton.style.display = 'none';
});
card.addEventListener('mouseover', (event) => {
    newButton.style.display = 'block';
});

card.addEventListener('mouseout', (event) => {
  newButton.style.display = 'none';
});

card.addEventListener('click', (event) => {
   if (doneButton.style.display == 'none'){
    newButton.style.display = 'block';
   }
});




doneButton.addEventListener('click', (event) => {
    if(titleInput.style.display === 'none'){
        titleInput.style.display = 'block';
        contentInput.style.display = 'block';

    }else{
        titleInput.style.display = 'none';
        contentInput.style.display = 'none';

    }
});

    title.addEventListener('click', (event) => {
    titleInput.style.display = 'block';
    contentInput.style.display = 'block';
});

content.addEventListener('click', (event) => {
    titleInput.style.display = 'block';
    contentInput.style.display = 'block';
});



let newButton = document.createElement('button');
newButton.innerHTML = "New";
card.appendChild(newButton);


newButton.addEventListener('click', (event) => {

    let leftContent = document.createElement('p');
    
    let rightContent = document.createElement('p');

    leftContent.innerHTML = 'left';

    card.appendChild(leftContent);
    card.appendChild(rightContent);

    let leftInput = document.createElement('input');
    leftInput.value = 'left';
    leftInput.addEventListener('input', (event) => {
        leftContent.innerHTML = event.target.value;
    });
    card.appendChild(leftInput);


    let rightInput = document.createElement('input');
    rightInput.value = 'right';
    rightInput.addEventListener('input', (event) => {
        rightContent.innerHTML = event.target.value;
    });
    card.appendChild(rightInput);

    doneButton.addEventListener('click', (event) => {
    if(leftInput.style.display === 'none'){
        leftInput.style.display = 'block';
        rightInput.style.display = 'block';
        

    }else{
        leftInput.style.display = 'none';
        rightInput.style.display = 'none';
        

        

    }
});
});


    

    
        
}


    window.onload = function () {
        createCardsFromJSON();
    };




</script>


</html>